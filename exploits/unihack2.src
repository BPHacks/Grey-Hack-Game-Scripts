// This script does effectively nothing. I want to expand it in the future to pull exploits from a text file so they don't have to be hard-coded.
host = get_shell.host_computer

if params.len != 1 then exit("usage: test [name of service to exploit]")

document = host.File(home_dir + "/exploits.txt")

if not document then exit("File does not exist.")

lines = document.content.split("\n")
if lines.len == 1 and lines[0] == "" then
	exit("File is empty. Nothing to search for.")
end if

print ("Found " + lines.len + " values. Searching for your desired exploit...")
valid_services = [ "ftp", "http", "smtp", "ssh", "sql" ]
for line in lines
	split = line.split(":")
	if split.len != 3 then exit("Syntax error with line (" + line + "): line should be separated by colons")
	foundValid = false
	for service in valid_services
		if split[0].lower == service then
			foundValid = true
			break
		end if
	end for
	if not foundValid then exit("File has no valid services")
	if split[1].indexOf("0x") == null then exit("Syntax error with line (" + line + "): second part of string should begin with 0x")
	if split[0] == params[0].lower then exit("Found match: " + split[1] + " " + split[2])
end for

print("No match found for " + params[0])
